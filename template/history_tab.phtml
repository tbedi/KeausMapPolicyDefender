<script type="text/javascript">
    window.onpageshow = function() {
        new JsDatePick({
            useMode: 2,
            target: "inputFieldto",
            dateFormat: "%Y-%m-%d"
        });

        new JsDatePick({
            useMode: 2,
            target: "inputFieldfrom",
            dateFormat: "%Y-%m-%d"
        });
    };
</script>
<div class="top-paneltab">Violations History</div>
  <div class=" divcc" >
                &NonBreakingSpace;
            </div> 
<table align="center">
    <tr>
    <td>
        <form action=" ?tab=violations-history&option=show_dates" method="post"> 
            <div class="divt22">
            From
            </div>
            <div class="divt22">
            <input type="text" class="search2" onclick="<?php $flagfrom = 1; ?>" size="12" name="from" id="inputFieldfrom" value="<?php echo $from; ?> " style=" background: white url(images/cal2.png) right no-repeat; padding-right: 10px;"/> 
  </div>
            <div class="divt22">  &NonBreakingSpace;</div>
        <div class="divt22">
        To
        </div>
           <div class="divt22">
        <input type="text" class="search2" onclick="<?php $flagto = 1; ?>" size="12" name="to" id="inputFieldto" value="<?php echo $to; ?> " style=" background: white url(images/cal2.png) right no-repeat; padding-right: 10px;"/>
</div>
            <div class="divt22">  &NonBreakingSpace;</div>
        <div class="divt22">
        <input type="submit" class="btn-search" name="submit" value="show" />
        </div>
        </form>
    </td>
</tr>
</table>
 <div  >
                &NonBreakingSpace;
            </div> 
   <div class=" divcc" >
                &NonBreakingSpace;
            </div> 


<table align="center" width="1000px"   >
    <tr>
        <td>
            <div class="divt1">
                <input class="history_violation_search search" placeholder="Enter SKU..." type="text" size="30"  maxlength="1000" value="<?php if (isset($_GET['action']) && $_GET['action'] == "searchh" && isset($_GET['tab']) && $_GET['tab'] == 'violations-history') echo $_GET['value']; ?>" id="textBoxSearch"    /> 
            </div>
            <div class="divt22">
                <button href="javascript:void(0);" class="btn-search"  onclick="history_violation_search();">Search</button>
            </div>
            <div class="divt22">
                <button href="javascript:void(0);" class="btn-search"  onclick="history_violation_show_all();" >Show all</button>
            </div>
        </td>


        <td> 
            <div class="divt1">
                <select  id="exporth" name="export_to" class="dropdown" >

                    <option value="csv" selected  >Excel csv</option>
                    <option value="xls" >Excel xls</option>
                    <option value="pdf" >PDF</option>

                </select>
            </div>
            <div class="divt22">
                <button href="" id="1" class="btn-search" onclick="exporttoh();">Export</button>
            </div>
        </td>


        <td>
            <div class="resultsh-per-page" >
                <select name="recent-limit" class="history-per-page dropdown"  >
                    <option  value="">Limit</option>
                        <option <?php // echo  ($limit==10) ? "selected" : "" ; ?> value="15">15</option>
            		<option  <?php //echo  ($limit==15) ? "selected" : "" ; ?> value="25">25</option>
            		<option  <?php // echo  ($limit==20) ? "selected" : "" ; ?>  value="50">50</option>
                        <option  <?php //echo  ($limit==15) ? "selected" : "" ; ?> value="75">75</option>
            		<option  <?php // echo  ($limit==20) ? "selected" : "" ; ?>  value="100">100</option>
                </select>
            </div>
        </td>

    </tr>
</table>
 <div class="cleaner" style="padding-top: 15px; ">

</div>
<br/>

<table class="GrayBlack" align="center">
    <tbody id="data">
        <tr> 
            <td>
                SKU
                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=sku&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "sku" ? $direction : "asc" ); ?>_1.png" />
                </a>
            </td>	
              <td>
                Seller
                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=wname&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "wname" ? $direction : "asc" ); ?>_1.png" />
                </a>
            </td>	
            <td>
                Vendor price
                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=vendor_price&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "vendor_price" ? $direction : "asc" ); ?>_1.png" />
                </a>
            </td>
            <td>
                MAP price
                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=map_price&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "map_price" ? $direction : "asc" ); ?>_1.png" />
                </a>

            </td>
            <td>
                Violation amt

                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=violation_amount&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "violation_amount" ? $direction : "asc" ); ?>_1.png" />
                </a>
            </td>
            <td>Date
                <a href="index.php?tab=<?php echo $tab_name; ?>&grid=history&dir=<?php echo ($direction == "asc" ? "desc" : "asc") ?>&sort=date_executed&<?php echo $page_param ?>=<?php echo $page ?><?php echo (isset($_GET['action']) && $_GET['action'] && isset($_GET['tab']) && $_GET['tab'] == 'violations-history' ? "&action=" . $_GET['action'] . "&field=" . $_GET['field'] . "&value=" . $_GET['value'] : "" ); ?><?php echo $additional_params; ?>" >
                    <img  style="float:right;" width="22" src="images/arrow_<?php echo ( $order_field == "date_executed" ? $direction : "asc" ); ?>_1.png" />
                </a>
            </td>

        </tr>

        <?php
        if (count($violators_array) == 0) {
            ?>
            <tr align="center"><td> No Records Found  </td> </tr>

            <?php
        }

        foreach ($violators_array as $violator) {

            $cell_id = "vio";
            if ($violator->violation_amount >= 5 && $violator->violation_amount < 10)
                $cell_id = "vioO";
            else if ($violator->violation_amount >= 10)
                $cell_id = "vioR";
            ?>
            <tr>
                <td><?php echo $violator->sku; ?></td>
                <td><?php echo $violator->wname; ?></td>
                <td><?php echo "$" . $violator->vendor_price; ?></td>
                <td><?php echo "$" . $violator->map_price; ?></td>
                <td id="<?php echo $cell_id; ?>"><?php echo "$" . $violator->violation_amount; ?></td>
                <td><?php echo $violator->date_executed; ?></td>

            </tr>				
        <?php } ?>



    </tbody></table> 

<div align="left" style="display:block; ">
    <?php include ('page2.php'); ?>
</div>		
 <div  >
                &NonBreakingSpace;
            </div> 
<div class=" divcc" >
                &NonBreakingSpace;
            </div> 
<div  class="chartt">
    <table>
        <tr>
            <td>
                <?php include_once 'charts/a5.php'; ?>
            </td>
            <td>
                <?php include_once 'charts/a6.php'; ?>
            </td>
        </tr>

    </table>
</div>

<script type="text/javascript">

    function history_violation_search() {
        var field = "sku";
        var value = $(".history_violation_search").val();
        var url_options = "";
        if (value.length) {
            url_options += "&action=searchh&field=" + field + "&value=" + value;
        }
        var search_link = "index.php?tab=violations-history" + url_options;
        window.open(search_link, "_self");


    }





    function exporttoh()
    {
        var mode = $("#exporth").val();
        var url_options = window.location.search.substring(1);

        if (url_options.length)
            url_options = '?' + url_options;

        if (mode)
            open("export/export_history_" + mode + ".php?" + $.param(queryParameters));
        //open("export_history_" + mode + ".php" + url_options);

    }

    function history_violation_show_all() {
        var search_link = "index.php?tab=violations-history";
        window.open(search_link, "_self");
    }

    $('.history-per-page').change(function() {
        var limith = $(this).val();
        var urlh = "";
        urlh = "tab=violations-history&";
        queryParameters['limith'] = limith;
        location.search = urlh + $.param(queryParameters);
      // location.search=$.param(queryParameters);
              
     // urlh = "index.php?tab=violations-history&limith=". limith;
      
     // location.search= $.param(queryParameters)+urlh;
      
      
    });

</script>